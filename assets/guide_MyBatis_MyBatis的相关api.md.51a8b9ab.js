import{_ as n,o as l,c as p,O as a,z as s}from"./chunks/framework.571309da.js";const q=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"guide/MyBatis/MyBatis的相关api.md","filePath":"guide/MyBatis/MyBatis的相关api.md","lastUpdated":1689575715000}'),o={name:"guide/MyBatis/MyBatis的相关api.md"},e=a(`<h3 id="_2-1-resources" tabindex="-1">2.1 Resources <a class="header-anchor" href="#_2-1-resources" aria-label="Permalink to &quot;2.1 Resources&quot;">​</a></h3><ul><li><p>org.apache.ibatis.io.Resources：加载资源的工具类。</p></li><li><p>核心方法</p></li></ul><p><img src="https://tcs-devops.aliyuncs.com/storage/112v124ef756c7bfac3217b6aead92b7ff71?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9hcHBJZCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY5MDE3ODI4MywiaWF0IjoxNjg5NTczNDgzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzExMnYxMjRlZjc1NmM3YmZhYzMyMTdiNmFlYWQ5MmI3ZmY3MSJ9.AiqXqon1Q_fxMSyAISDtBwoX2NI9mSwY6DVuPBdLlVk&amp;download=%E5%9B%BE%E7%89%87.png" alt=""></p><h3 id="_2-2-构建器sqlsessionfactorybuilder" tabindex="-1">2.2 构建器SqlSessionFactoryBuilder <a class="header-anchor" href="#_2-2-构建器sqlsessionfactorybuilder" aria-label="Permalink to &quot;2.2 构建器SqlSessionFactoryBuilder&quot;">​</a></h3><p>建造者设计模式：</p><ul><li><p>org.apache.ibatis.session.SqlSessionFactoryBuilder：获取 SqlSessionFactory 工厂对象的功能类</p></li><li><p>核心方法</p></li></ul><p><img src="https://tcs-devops.aliyuncs.com/storage/112v522de4fb19908d6e6ae7e57754ecfe8e?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9hcHBJZCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY5MDE3ODI4MywiaWF0IjoxNjg5NTczNDgzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzExMnY1MjJkZTRmYjE5OTA4ZDZlNmFlN2U1Nzc1NGVjZmU4ZSJ9.nk_bf20ZJFU-7LFzR8m1bD9qY2VG-zejdfc47pFAet4&amp;download=%E5%9B%BE%E7%89%87.png" alt=""></p><ul><li>通过加载mybatis的核心文件的输入流的形式构建一个SqlSessionFactory对象</li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> resource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">org/mybatis/builder/mybatis-config.xml</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#C792EA;">InputStream</span><span style="color:#A6ACCD;"> inputStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Resources</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getResourceAsStream</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">resource</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#C792EA;">SqlSessionFactoryBuilder</span><span style="color:#A6ACCD;"> builder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SqlSessionFactoryBuilder</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#C792EA;">SqlSessionFactory</span><span style="color:#A6ACCD;"> factory </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">inputStream</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>其中， Resources 工具类，这个类在 org.apache.ibatis.io 包中。Resources 类帮助你从类路径下、文件系统或一个 web URL 中加载资源文件。</p><h3 id="_2-3-工厂对象sqlsessionfactory" tabindex="-1">2.3 工厂对象SqlSessionFactory <a class="header-anchor" href="#_2-3-工厂对象sqlsessionfactory" aria-label="Permalink to &quot;2.3 工厂对象SqlSessionFactory&quot;">​</a></h3><p>工厂设计模式：</p><ul><li><p>org.apache.ibatis.session.SqlSessionFactory：获取 SqlSession 构建者对象的工厂接口。</p></li><li><p>核心api</p></li></ul><p><img src="https://tcs-devops.aliyuncs.com/storage/112v89cd717f619009c297f4bf7db3685465?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9hcHBJZCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY5MDE3ODI4MywiaWF0IjoxNjg5NTczNDgzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzExMnY4OWNkNzE3ZjYxOTAwOWMyOTdmNGJmN2RiMzY4NTQ2NSJ9.nybOSOJu6hlmrvyoM40oHwDG8LYJZh4Cq6iChKbxsh0&amp;download=%E5%9B%BE%E7%89%87.png" alt=""></p><p>2.4 SqlSession会话对象</p><ul><li><p>org.apache.ibatis.session.SqlSession：构建者对象接口。用于执行 SQL、管理事务、接口代理。</p></li><li><p>核心api</p></li></ul><p><img src="https://tcs-devops.aliyuncs.com/storage/112v6051fcc63eefe4627b73dec464f8d2dd?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9hcHBJZCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY5MDE3ODI4MywiaWF0IjoxNjg5NTczNDgzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzExMnY2MDUxZmNjNjNlZWZlNDYyN2I3M2RlYzQ2NGY4ZDJkZCJ9.81iq-MJ_fn5Lkcu3_UUDu66HGMfx3zOGUJvsriVlegY&amp;download=%E5%9B%BE%E7%89%87.png" alt=""></p><p>SqlSession 实例在 MyBatis 中是非常强大的一个类。在这里你会看到所有执行语句、提交或回滚事务和获取映射器实例的方法。</p><h3 id="三、接口代理方式实现dao" tabindex="-1">三、接口代理方式实现Dao <a class="header-anchor" href="#三、接口代理方式实现dao" aria-label="Permalink to &quot;三、接口代理方式实现Dao&quot;">​</a></h3><h3 id="_1-1-代理开发方式介绍" tabindex="-1">1.1 代理开发方式介绍 <a class="header-anchor" href="#_1-1-代理开发方式介绍" aria-label="Permalink to &quot;1.1 代理开发方式介绍&quot;">​</a></h3><p>采用 Mybatis 的代理开发方式实现 DAO 层的开发，这种方式是我们后面进入企业的主流。</p><p>Mapper 接口开发方法只需要程序员编写Mapper 接口（相当于Dao 接口），由Mybatis 框架根据接口定义创建接口的动态代理对象，代理对象的方法体同上边Dao接口实现类方法。</p><p>Mapper 接口开发需要遵循以下规范：</p><p><strong>1) Mapper.xml文件中的namespace与mapper接口的全限定名相同</strong></p><p><strong>2) Mapper接口方法名和Mapper.xml中定义的每个statement的id相同</strong></p><p><strong>3) Mapper接口方法的输入参数类型和mapper.xml中定义的每个sql的parameterType的类型相同</strong></p><p><strong>4) Mapper接口方法的返回值类型和mapper.xml中定义的每个sql的resultType的类型相同</strong></p><p>总结:</p><p>接口开发的方式: 程序员只需定义接口,就可以对数据库进行操作,那么具体的对象怎么创建?</p><p>1.程序员负责定义接口</p><p>2.在操作数据库,mybatis框架根据接口,通过动态代理的方式生成代理对象,负责数据库的crud操作</p><h3 id="mybatis-映射配置文件" tabindex="-1">MyBatis 映射配置文件 <a class="header-anchor" href="#mybatis-映射配置文件" aria-label="Permalink to &quot;MyBatis 映射配置文件&quot;">​</a></h3><h3 id="_3-1-映射配置文件介绍" tabindex="-1">3.1 映射配置文件介绍 <a class="header-anchor" href="#_3-1-映射配置文件介绍" aria-label="Permalink to &quot;3.1 映射配置文件介绍&quot;">​</a></h3><ul><li>映射配置文件包含了数据和对象之间的映射关系以及要执行的 SQL 语句</li></ul><p><img src="https://tcs-devops.aliyuncs.com/storage/112vb564eac14ba2dbbada2a31f1913c655c?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9hcHBJZCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY5MDE3ODI4MywiaWF0IjoxNjg5NTczNDgzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzExMnZiNTY0ZWFjMTRiYTJkYmJhZGEyYTMxZjE5MTNjNjU1YyJ9.sP-ip2I6r0wNKksdI8e3qzHgvYiUUqZFeTfeUwrbg-c&amp;download=%E5%9B%BE%E7%89%87.png" alt=""></p><p>3.2 查询功能</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">&lt;Select&gt; 查询功能标签</span></span></code></pre></div><ul><li><p>属性 id：唯一标识， 配合名称空间使用。</p></li><li><p>parameterType：指定参数映射的对象类型。</p></li><li><p>resultType：指定结果映射的对象类型。</p></li><li><p>SQL 获取参数: #{属性名} #表示方式sql注入的 $ 表示sql拼接 where id=1 1=1</p></li><li><p>示例</p></li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;">  java</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">lang</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Integer</span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">select id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">findById</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> parameterType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">java.lang.String</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> resultType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.by.pojo.User</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from user where id</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">select</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><h3 id="_3-3-新增功能" tabindex="-1">3.3 新增功能 <a class="header-anchor" href="#_3-3-新增功能" aria-label="Permalink to &quot;3.3 新增功能&quot;">​</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">&lt;insert&gt;：新增功能标签。</span></span></code></pre></div>`,41),t=s("ul",null,[s("li",null,[s("p",null,"属性 id：唯一标识， 配合名称空间使用。"),s("ul",null,[s("li",null,"parameterType：指定参数映射的对象类型。")])]),s("li",{属性名:""},[s("p",null,"SQL 获取参数: #")]),s("li",null,[s("p",null,"示例")])],-1),c=a(`<p>操作步骤：</p><p>第一步、编写dao接口</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>第二步、编写映射文件</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">insert id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">save</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> parameterType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.by.pojo.User</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    insert into user </span><span style="color:#82AAFF;">values</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">sex</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">address</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">birthday</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">insert</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>第三步、测试代码</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">saveTest</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//读取配置文件</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">InputStream</span><span style="color:#A6ACCD;"> is </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Resources</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getResourceAsStream</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mybatis-config.xml</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//获取建造者对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSessionFactoryBuilder</span><span style="color:#A6ACCD;"> builder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SqlSessionFactoryBuilder</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSessionFactory</span><span style="color:#A6ACCD;"> sessionFactory </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">is</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> session </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sessionFactory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">openSession</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">UserDao</span><span style="color:#A6ACCD;"> mapper </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">UserDao</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">User</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#676E95;font-style:italic;">// user.setId(1);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setUsername</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">张三</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setSex</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setAddress</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">河南开封</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setBirthday</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2010-09-12</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//提交数据</span></span>
<span class="line"><span style="color:#A6ACCD;">     session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">commit</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//释放资源</span></span>
<span class="line"><span style="color:#A6ACCD;">    is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>3.4 修改功能</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">update</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">：修改功能标签。</span></span></code></pre></div>`,9),r=s("ul",null,[s("li",null,[s("p",null,"属性 id：唯一标识， 配合名称空间使用。"),s("ul",null,[s("li",null,"parameterType：指定参数映射的对象类型。")])]),s("li",{属性名:""},[s("p",null,"SQL 获取参数: #")]),s("li",null,[s("p",null,"示例")])],-1),D=a(`<p>1、编写dao接口</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">update</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>2、编写映射文件</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">update</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">update</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">parameterType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.by.pojo.User</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    update user set username=#{username},sex=#{sex} where id=#{id}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">update</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>3、测试运行</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">update</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//读取配置文件</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">InputStream</span><span style="color:#A6ACCD;"> is </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Resources</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getResourceAsStream</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mybatis-config.xml</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//获取建造者对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSessionFactoryBuilder</span><span style="color:#A6ACCD;"> builder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SqlSessionFactoryBuilder</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSessionFactory</span><span style="color:#A6ACCD;"> sessionFactory </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">is</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> session </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sessionFactory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">openSession</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">UserDao</span><span style="color:#A6ACCD;"> mapper </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">UserDao</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">User</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setId</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setUsername</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">张三</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setSex</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">女</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">update</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#676E95;font-style:italic;">//提交数据</span></span>
<span class="line"><span style="color:#A6ACCD;">     session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">commit</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//释放资源</span></span>
<span class="line"><span style="color:#A6ACCD;">    is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>3.5 删除功能</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">delete</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">：查询功能标签。</span></span></code></pre></div>`,8),y=s("ul",null,[s("li",null,[s("p",null,"属性 id：唯一标识， 配合名称空间使用。"),s("ul",null,[s("li",null,"parameterType：指定参数映射的对象类型。")])]),s("li",{属性名:""},[s("p",null,"SQL 获取参数: #")])],-1),i=a(`<p>1、编写dao接口</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> id</span><span style="color:#89DDFF;">);</span></span></code></pre></div><ul><li>示例</li></ul><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">delete</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">delete</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">parameterType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">java.lang.Integer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    delete from user where id=#{id}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">delete</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>3、测试运行</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">delTest</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">InputStream</span><span style="color:#A6ACCD;"> is </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Resources</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getResourceAsStream</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mybatis-config.xml</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//获取建造者对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSessionFactoryBuilder</span><span style="color:#A6ACCD;"> builder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SqlSessionFactoryBuilder</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSessionFactory</span><span style="color:#A6ACCD;"> sessionFactory </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">is</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> session </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sessionFactory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">openSession</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">UserDao</span><span style="color:#A6ACCD;"> mapper </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">UserDao</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#676E95;font-style:italic;">//提交数据</span></span>
<span class="line"><span style="color:#A6ACCD;">     session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">commit</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//释放资源</span></span>
<span class="line"><span style="color:#A6ACCD;">    is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><ul><li>总结： 大家可以发现crud操作，除了标签名称以及sql语句不一样之外，其他属性参数基本一致。</li></ul><h3 id="_3-6抽取工具类" tabindex="-1">3.6抽取工具类 <a class="header-anchor" href="#_3-6抽取工具类" aria-label="Permalink to &quot;3.6抽取工具类&quot;">​</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">public class MybatisUtils {</span></span>
<span class="line"><span style="color:#A6ACCD;">    //定义静态的session工厂对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    static SqlSessionFactory sqlSessionFactory;</span></span>
<span class="line"><span style="color:#A6ACCD;">    static {</span></span>
<span class="line"><span style="color:#A6ACCD;">        //读取配置文件</span></span>
<span class="line"><span style="color:#A6ACCD;">        try {</span></span>
<span class="line"><span style="color:#A6ACCD;">            InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">            SqlSessionFactoryBuilder builder=new SqlSessionFactoryBuilder();</span></span>
<span class="line"><span style="color:#A6ACCD;">            sqlSessionFactory = builder.build(is);</span></span>
<span class="line"><span style="color:#A6ACCD;">        } catch (IOException e) {</span></span>
<span class="line"><span style="color:#A6ACCD;">            e.printStackTrace();</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    //提交</span></span>
<span class="line"><span style="color:#A6ACCD;">    public static SqlSession getSqlSession(boolean autocommit){</span></span>
<span class="line"><span style="color:#A6ACCD;">        return sqlSessionFactory.openSession(autocommit);</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    //关闭</span></span>
<span class="line"><span style="color:#A6ACCD;">    public static void closeSqlSession(SqlSession sqlSession){</span></span>
<span class="line"><span style="color:#A6ACCD;">        sqlSession.close();</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>测试操作：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">@Test</span></span>
<span class="line"><span style="color:#A6ACCD;">public void findTest() throws IOException {</span></span>
<span class="line"><span style="color:#A6ACCD;">    //调用utils里面的getsqlSession 包含提交操作</span></span>
<span class="line"><span style="color:#A6ACCD;">    SqlSession session = MybatisUtils.getSqlSession(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    UserDao mapper = session.getMapper(UserDao.class);</span></span>
<span class="line"><span style="color:#A6ACCD;">    List&lt;User&gt; all = mapper.findAll();</span></span>
<span class="line"><span style="color:#A6ACCD;">    for (User user : all) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        System.out.println(user);</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    //释放资源</span></span>
<span class="line"><span style="color:#A6ACCD;">    MybatisUtils.closeSqlSession(session);</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><h3 id="_3-6-注解实现案例" tabindex="-1">3.6 注解实现案例 <a class="header-anchor" href="#_3-6-注解实现案例" aria-label="Permalink to &quot;3.6 注解实现案例&quot;">​</a></h3><p>@insert 添加操作</p><pre><code>1、编写mapper接口
</code></pre><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Insert</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">insert into T_user values(#{id},#{username},#{sex},#{address},#{birthday})</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>2、编写测试类</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">insertTest</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> sqlSession </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MybatisUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getSqlSession</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">IUsermapper</span><span style="color:#A6ACCD;"> mapper </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSession</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">IUsermapper</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">User</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setUsername</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">胡二小</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setSex</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">女</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setAddress</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">郑州</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setBirthday</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2001-09-12</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//释放资源</span></span>
<span class="line"><span style="color:#A6ACCD;">    MybatisUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">closeSqlSession</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">sqlSession</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>@update修改操作</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">@Update(&quot;update T_user set username=#{username},sex=#{sex} where id=#{id}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">public void update(User user);</span></span></code></pre></div><p>@Delete删除操作</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">@Delete(&quot;delete from T_user where id=#{id}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">public void delete(int id);</span></span></code></pre></div><h3 id="_3-7问题扩展-新增用户-id-的返回值" tabindex="-1">3.7问题扩展：新增用户 <strong>id</strong> 的返回值 <a class="header-anchor" href="#_3-7问题扩展-新增用户-id-的返回值" aria-label="Permalink to &quot;3.7问题扩展：新增用户 **id** 的返回值&quot;">​</a></h3><p>新增用户后， 同时还要返回当前新增用户的 id 值， 因为 id 是由数据库的自动增长来实现的，所以就相</p><p>当于我们要在新增后将自动增长 auto_increment 的值返回。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">insert id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">saveUser</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> parameterType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;">配置保存时获取插入的id</span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;"> selectKey：是指要执行相关的sql</span></span>
<span class="line"><span style="color:#A6ACCD;">            order</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> selectKey中sql执行的顺序，after 代表之后，before代表之前</span></span>
<span class="line"><span style="color:#A6ACCD;">            keyProperty：指的是实体类中的属性</span></span>
<span class="line"><span style="color:#A6ACCD;">            keyColumn</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> 指定的是数据库表中的主键字段名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">selectKey order</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">AFTER</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> keyProperty</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> keyColumn</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> resultType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">int</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            select </span><span style="color:#82AAFF;">last_insert_id</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">selectKey</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">​</span></span>
<span class="line"><span style="color:#A6ACCD;">insert into </span><span style="color:#82AAFF;">T_user</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">sex</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">address</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">birthday</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">values</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">sex</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">address</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;">#</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">birthday</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">insert</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>第二种方式：</p><p>使用<strong>useGeneratedKeys结合</strong>keyProperty 完成自增id获取</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">useGeneratedKeys:（只作用于 insert 和 update ）这会令 MyBatis 使用 JDBC 的 getGeneratedKeys 方法来取出由数据库内部生成的主键（比如：像 MySql 和 SqlServer 这类关系数据库管理系统中的自动递增字段）。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">keyProperty:（只作用于 insert 和 update）唯一标记一个属性，MyBatis 会通过 getGeneratedKeys 的返回值或者通过 insert 语句的 selectKey 子元素设置它的键值，默认：unset。如果希望得到多个生成的列，也可以是逗号分隔的属性名称列表。(这里 mysql 里的自增主键是 id)</span></span>
<span class="line"><span style="color:#A6ACCD;">代码=====</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">insert</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">save</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">parameterType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">useGeneratedKeys</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">keyProperty</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">insert into user values(#{id},#{username},#{sex},#{address},#{birthday})</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">insert</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p><strong>编写步骤：</strong></p><p>1、在dao中添加一个方法</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">public void saveUser(User user);</span></span></code></pre></div><p>2、编写映射</p><p>3、编写测试</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">@Test</span></span>
<span class="line"><span style="color:#A6ACCD;">public void saveTest() throws IOException {</span></span>
<span class="line"><span style="color:#A6ACCD;">    SqlSession sqlSession = MybatisUtils.getSqlSession(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    UserDao mapper = sqlSession.getMapper(UserDao.class);</span></span>
<span class="line"><span style="color:#A6ACCD;">    User user=new User();</span></span>
<span class="line"><span style="color:#A6ACCD;">   // user.setId(1);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user.setUsername(&quot;小李子&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user.setSex(&quot;男&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user.setAddress(&quot;郑州&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">    user.setBirthday(Date.valueOf(&quot;2011-09-12&quot;));</span></span>
<span class="line"><span style="color:#A6ACCD;">    //mapper.save(user);</span></span>
<span class="line"><span style="color:#A6ACCD;">    mapper.saveUser(user);</span></span>
<span class="line"><span style="color:#A6ACCD;">    //打印id的值</span></span>
<span class="line"><span style="color:#A6ACCD;">    System.out.println(&quot;userId=&quot;+user.getId());</span></span>
<span class="line"><span style="color:#A6ACCD;">   MybatisUtils.closeSqlSession(sqlSession);</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>总体解释：将插入数据的主键返回到 user 对象中。</p><ul><li><p>具体解释：</p></li><li><p>SELECT LAST_INSERT_ID()：得到刚 insert 进去记录的主键值，只适用与自增主键</p></li><li><p>keyProperty：将查询到主键值设置到 parameterType 指定的对象的那个属性</p></li><li><p>keyColumn 指定的是表中的主键字段名</p></li><li><p>resultType：指定 SELECTLAST_INSERT_ID() 的结果类型</p></li></ul><p>3.7 映射配置文件小结</p><p><img src="https://tcs-devops.aliyuncs.com/storage/112va82fff1c2d3d6c540e7f8e3d96c8d28d?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9hcHBJZCI6IjVlNzQ4MmQ2MjE1MjJiZDVjN2Y5YjMzNSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY5MDE3ODI4MywiaWF0IjoxNjg5NTczNDgzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzExMnZhODJmZmYxYzJkM2Q2YzU0MGU3ZjhlM2Q5NmM4ZDI4ZCJ9.YeJsIQUf041p7wH8xScrKAe__wRMGgzf2r-a_YohbHc&amp;download=%E5%9B%BE%E7%89%87.png" alt=""></p>`,38),F=[e,t,c,r,D,y,i];function A(C,u,d,m,g,h){return l(),p("div",null,F)}const I=n(o,[["render",A]]);export{q as __pageData,I as default};
