### 1.DispatcherServlet

  ä½œç”¨ï¼šç»Ÿä¸€æ”¶å£ï¼Œæ¥æ”¶è¯·æ±‚ï¼Œå“åº”ç»“æœï¼Œç›¸å½“äºè½¬å‘å™¨ï¼Œä¸­å¤®å¤„ç†å™¨ã€‚æœ‰äº†DispatcherServletå‡å°‘äº†å…¶å®ƒç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ã€‚

### 2.HandlerMapping-å¤„ç†å™¨æ˜ å°„å™¨

ä½œç”¨ï¼šæ ¹æ®è¯·æ±‚çš„urlæŸ¥æ‰¾Handlerï¼Œæ—¢è´Ÿè´£å®Œæˆå®¢æˆ·è¯·æ±‚åˆ° Controller æ˜ å°„ã€‚SpringMVCæä¾›äº†ä¸åŒçš„æ˜ å°„å™¨å®ç°å®ç°ä¸åŒçš„æ˜ å°„æ–¹å¼ï¼Œä¾‹å¦‚ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ã€å®ç°æ¥å£æ–¹å¼ã€æ³¨è§£æ–¹å¼ç­‰ã€‚

### 3.HandlerAdapter-å¤„ç†å™¨é€‚é…å™¨

ä½œç”¨ï¼šæŒ‰ç…§ç‰¹å®šè§„åˆ™å»æ‰§è¡ŒHandlerã€‚

### 4.Handler-å¤„ç†å™¨ ä¹Ÿå« Controller

Handleræ˜¯ç»§DispatcherServletå‰ç«¯æ§åˆ¶å™¨çš„åç«¯æ§åˆ¶å™¨ï¼Œåœ¨DispatcherServletçš„æ§åˆ¶ä¸‹ï¼ŒHandlerå¯¹å…·ä½“çš„ç”¨æˆ·è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚

### 5.è§†å›¾è§£æå™¨ViewResolver

ä½œç”¨ï¼šè¿›è¡Œè§†å›¾è§£æï¼Œæ ¹æ®é€»è¾‘è§†å›¾åè§£ææˆçœŸæ­£çš„è§†å›¾ï¼ˆviewï¼‰

ViewResolverè´Ÿè´£å°†å¤„ç†ç»“æœç”ŸæˆViewè§†å›¾ï¼ŒViewResolveré¦–å…ˆæ ¹æ®é€»è¾‘è§†å›¾åè§£ææˆç‰©ç†è§†å›¾åï¼Œå³å…·ä½“çš„é¡µé¢åœ°å€ï¼Œå†ç”ŸæˆViewè§†å›¾å¯¹è±¡ï¼Œæœ€åå¯¹Viewè¿›è¡Œæ¸²æŸ“å°†å¤„ç†ç»“æœé€šè¿‡é¡µé¢çš„å±•ç¤ºç»™ç”¨æˆ·ã€‚SpringMVCæ¡†æ¶æä¾›äº†å¾ˆå¤šViewè§†å›¾ç±»å‹ï¼ŒåŒ…æ‹¬ï¼šJSTLViewã€freemarkerViewã€pdfViewç­‰ç­‰.

### 6.è§†å›¾View

æ³¨æ„ï¼šViewæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ç°ç±»æ”¯æŒä¸åŒçš„Viewç±»å‹ï¼ˆjspã€freemarkerâ€¦ï¼‰ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éœ€è¦é€šè¿‡é¡µé¢æ ‡ç­¾æˆ–è€…é¡µé¢æ¨¡æ¿æŠ€æœ¯å°†æ¨¡å‹æ•°æ®é€šè¿‡é¡µé¢å±•ç¤ºç»™ç”¨æˆ·ï¼Œéœ€è¦ç”±ç¨‹åºå‘˜æ ¹æ®ä¸šåŠ¡éœ€æ±‚å¼€å‘å…·ä½“çš„é¡µé¢ã€‚

> æ€»ç»“ï¼š éœ€è¦æˆ‘ä»¬å¼€å‘çš„å·¥ä½œåªæœ‰å¤„ç†å™¨ Handler çš„ç¼–å†™ä»¥åŠè§†å›¾æ¯”å¦‚JSPé¡µé¢çš„ç¼–å†™ã€‚



## 3.ç»„ä»¶é…ç½®è¯´æ˜

### 1.é…ç½®å‰ç«¯æ§åˆ¶å™¨ï¼ˆDispatcherServletï¼‰

åœ¨web projectçš„web.xmlä¸­é…ç½®ï¼š

```java
<!-- é…ç½®å‰ç«¯æ§åˆ¶å™¨DispatcherServlet -->
<servlet>
 Â  Â <servlet-name>springmvc</servlet-name>
 Â  Â <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
 Â  Â <!--springmvc.xml æ˜¯è‡ªå·±åˆ›å»ºçš„SpringMVCå…¨å±€é…ç½®æ–‡ä»¶ï¼Œç”¨contextConfigLocationä½œä¸ºå‚æ•°åæ¥åŠ è½½ 
 Â  Â  Â  Â å¦‚æœä¸é…ç½® contextConfigLocationï¼Œé‚£ä¹ˆé»˜è®¤åŠ è½½çš„æ˜¯/WEB-INF/servletåç§°-servlet.xmlï¼Œåœ¨è¿™é‡Œä¹Ÿå°±æ˜¯ 
 Â  Â  Â  Â springmvc-servlet.xml å‚æ•°å¤šä¸ªå€¼ä½¿ç”¨é€—å·éš”å¼€ï¼Œå¦‚ï¼ša.xml,b.xml -->
 Â  Â <init-param>
 Â  Â  Â  Â <param-name>contextConfigLocation</param-name>
 Â  Â  Â  Â <param-value>classpath:spring.xml</param-value>
 Â  Â </init-param>
 Â  Â <load-on-startup>1</load-on-startup>
</servlet>
â€‹
<servlet-mapping>
 Â  Â <servlet-name>springmvc</servlet-name>
 Â  Â <!--ç¬¬ä¸€ç§é…ç½®ï¼š*.do,è¿˜å¯ä»¥å†™*.actionç­‰ç­‰ï¼Œè¡¨ç¤ºä»¥.doç»“å°¾çš„æˆ–è€…ä»¥.actionç»“å°¾çš„URLéƒ½ç”±å‰ç«¯æ§åˆ¶å™¨DispatcherServletæ¥è§£æ 
 Â  Â  Â  Â ç¬¬äºŒç§é…ç½®ï¼š/,æ‰€æœ‰è®¿é—®çš„ URL éƒ½ç”±DispatcherServletæ¥è§£æï¼Œä½†æ˜¯è¿™é‡Œæœ€å¥½é…ç½®é™æ€æ–‡ä»¶ä¸ç”±DispatcherServletæ¥è§£æï¼Œéœ€è¦å¯¹é™æ€èµ„æºå•ç‹¬å¤„ç† 
 Â  Â  Â  Â é”™è¯¯é…ç½®ï¼š/*,æ³¨æ„è¿™é‡Œæ˜¯ä¸èƒ½è¿™æ ·é…ç½®çš„ï¼Œå› ä¸ºå¦‚æœè¿™æ ·å†™ï¼Œæœ€åè½¬å‘åˆ° jsp é¡µé¢çš„æ—¶å€™ï¼Œä»ç„¶ä¼šç”±DispatcherServletè¿›è¡Œè§£æï¼Œ è€Œè¿™æ—¶å€™ä¼šæ‰¾ä¸åˆ°å¯¹åº”çš„Handlerï¼Œä»è€ŒæŠ¥404ï¼ï¼ï¼ -->
 Â  Â <url-pattern>/</url-pattern>
</servlet-mapping>
```

### 2.é…ç½®å¤„ç†å™¨æ˜ å°„å™¨ï¼ˆHandlerMappingï¼‰

åœ¨ springmvc.xml æ–‡ä»¶ä¸­é…ç½®ã€‚é€šä¿—æ¥è®²å°±æ˜¯è¯·æ±‚çš„ URL æ€ä¹ˆèƒ½è¢« SpringMVC è¯†åˆ«ï¼Œä»è€Œå»æ‰§è¡Œæˆ‘ä»¬ç¼–å†™å¥½çš„ Handlerã€‚

(1) ç¬¬ä¸€ç§æ–¹æ³•

```text
<!-- é…ç½®Handler é€šè¿‡nameçš„å€¼ä¸ºurlæ¥è¯·æ±‚-->   
<bean name="/hello2" class="com.beiyou.controller.HelloController2" />

//Handler
//æˆ‘ä»¬çš„è¿™ä¸ªcontroller å°±æ˜¯ä¸€ä¸ªHandlerï¼ˆæ‰§è¡Œå™¨ï¼‰
public class HelloWord2 implements Controller {
    public ModelAndView handleRequest(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse) throws Exception {
        ModelAndView mv=new ModelAndView();
        //å¦‚æœxmlç»Ÿä¸€é…ç½®è·¯å¾„ï¼Œå¯ä»¥ç®€å†™ç¨‹æ–‡ä»¶å
        mv.setViewName("success");
        mv.addObject("msg","ä»Šå¤©å¤©æ°”å¾ˆå†·");
        return mv;
    }
}

```

è¿™æ ·é…ç½®çš„è¯ï¼Œé‚£ä¹ˆè¯·æ±‚çš„ URLï¼Œå¿…é¡»ä¸º [http://ip:port/](http://ip:port/)é¡¹ç›®å/hello

(2) ç¬¬äºŒç§æ–¹æ³•

```text
<!-- é…ç½®Handler  é€šè¿‡keyå€¼åšä¸ºurlæ¥è®¿é—®å¯¹åº”çš„bean--> Â  
<bean id="hello2" class="com.beiyou.controller.HelloController2" />
<bean id="hello3" class="com.beiyou.controller.HelloController2" />
<!-- ç®€å•URLé…ç½®å¤„ç†å™¨æ˜ å°„å™¨ -->
<bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
 Â  Â <property name="mappings">
 Â  Â  Â  Â <props>
 Â  Â  Â  Â  Â  Â <prop key="/hello2">hello</prop>
 Â  Â  Â  Â  Â  Â <prop key="/hello3">hello2</prop>
 Â  Â  Â  Â </props>
 Â  Â </property>
</bean>
```

è¿™ç§é…ç½®è¯·æ±‚çš„ URLå¯ä»¥ä¸º [http://ip:prot/](http://ip:prot/)é¡¹ç›®å/hello**ï¼Œæˆ–è€…**[**http://ip:port/**](http://ip:port/)**é¡¹ç›®å/hello2**

### 3.é…ç½®å¤„ç†å™¨é€‚é…å™¨ï¼ˆHandlerAdapterï¼‰

åœ¨ springmvc.xml æ–‡ä»¶ä¸­é…ç½®ã€‚ç”¨æ¥çº¦æŸæˆ‘ä»¬æ‰€éœ€è¦ç¼–ç çš„ Handlerç±»ã€‚

**ç¬¬ä¸€ç§**

  ç¼–å†™ Handler æ—¶å¿…é¡»è¦å®ç° Controllerï¼Œå¦åˆ™ä¸èƒ½è¢«é€‚é…å™¨è§£æã€‚

```text
<!-- é…ç½®å¤„ç†å™¨é€‚é…å™¨ï¼Œæ‰€æœ‰é€‚é…å™¨éƒ½å¾—å®ç° HandlerAdapteræ¥å£ å¤„ç†å™¨å¿…é¡»å®ç°controlleræ¥å£çš„handler-->
<bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter" />
```

***ç¬¬äºŒç§***

ç¼–å†™ Handler æ—¶å¿…é¡»è¦å®ç° HttpRequestHandler

```text
<!-- é…ç½®å¤„ç†å™¨é€‚é…å™¨ç¬¬äºŒç§æ–¹æ³•ï¼Œè¿™æ ·é…ç½®æ‰€æœ‰Handleréƒ½å¿…é¡»å®ç° HttpRequestHandleræ¥å£-->
<bean class="org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter" />
```

ğŸ‘‹

1ã€å¦‚æœæ²¡æœ‰æŒ‡æ˜ï¼Œåˆ™å¯ä»¥åŒæ—¶å¤„ç†å®ç°Controlleræ¥å£å’ŒHttpRequestHandleræ¥å£çš„handlerã€‚

2ã€å¦‚æœæŒ‡æ˜å…¶ä¸­ä¸€ç§ï¼Œåˆ™è¦æ±‚æ‰€æœ‰çš„handerç±»éƒ½å¿…é¡»å®ç°å¯¹åº”çš„æ¥å£ï¼Œå¦åˆ™æ— æ³•è®¿é—®ã€‚

### 4.å¤„ç†å™¨ï¼ˆHandlerï¼Œå³æˆ‘ä»¬çš„Controllerï¼‰

åœ¨ springmvc.xml æ–‡ä»¶ä¸­é…ç½®ã€‚é€šä¿—æ¥è®²ï¼Œå°±æ˜¯è¯·æ±‚çš„ URL åˆ°æˆ‘ä»¬è¿™é‡Œæ‰€ç¼–å†™çš„ Handler ç±»çš„æŸä¸ªæ–¹æ³•è¿›è¡Œä¸€äº›ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚æˆ‘ä»¬åœ¨ä¸Šé¢è®²è§£äº†ä¸¤ä¸ªå¤„ç†å™¨é€‚é…å™¨æ¥çº¦æŸ Handlerï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±é€šè¿‡ä¸Šé¢ä¸¤ç§é…ç½®åˆ†åˆ«ç¼–å†™ä¸¤ä¸ª Handlerï¼š

***(1) ç¬¬ä¸€ç§***

å®ç°Controller æ¥å£

```java
//Handler
//æˆ‘ä»¬çš„è¿™ä¸ªcontroller å°±æ˜¯ä¸€ä¸ªHandlerï¼ˆæ‰§è¡Œå™¨ï¼‰
public class HelloWord implements Controller {
 Â  Â public ModelAndView handleRequest(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse) throws Exception {
 Â  Â  Â  Â ModelAndView mv=new ModelAndView();
 Â  Â  Â  Â //å¦‚æœxmlç»Ÿä¸€é…ç½®è·¯å¾„ï¼Œå¯ä»¥ç®€å†™ç¨‹æ–‡ä»¶å
 Â  Â  Â  Â mv.setViewName("success");
 Â  Â  Â  Â mv.addObject("msg","ä»Šå¤©å¤©æ°”å¾ˆå†·");
 Â  Â  Â  Â return mv;
 Â   }
}
```

**(2) ç¬¬äºŒç§**  HttpRequestHandler

```java
public class HelloController2 implements HttpRequestHandler {
 Â  Â public void handleRequest(HttpServletRequest request, HttpServletResponse response)
 Â  Â  Â  Â  Â  Â throws ServletException, IOException {
 Â  Â  Â  Â request.setAttribute("msg", "æµ‹è¯•æ•°æ®");
 Â  Â  request.getRequestDispatcher("/WEB-INF/success.jsp").forward(request, response);
 Â   }
}
```

â³ é€šå¸¸æˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼æ¥ç¼–å†™ Handler ï¼Œä½†æ˜¯ç¬¬äºŒç§å¦‚æœä¸éœ€è¦æ¸²æŸ“è§†å›¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ response ä¿®æ”¹ç›¸åº”å†…å®¹ï¼Œæ¯”å¦‚è¿”å› json æ•°æ®ï¼šå¦‚ä¸‹å›¾ï¼š

```java
response.setCharacterEncoding("utf-8");
response.setContentType("application/json;charset=utf-8");
response.getWriter().write("jsonå­—ç¬¦ä¸²");
//controllerç¤ºä¾‹
public class HelloWord2 implements HttpRequestHandler {
 Â  Â @Override
 Â  Â public void handleRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
â€‹
 Â  Â  Â  Â response.setCharacterEncoding("utf-8");
 Â  Â  Â  Â response.setContentType("application/json;charset=utf-8");
 Â  Â  Â  Â response.getWriter().write("jsonå­—ç¬¦ä¸²");
 Â   }
}
```

### 5.é…ç½®è§†å›¾è§£æå™¨ï¼ˆViewResolverï¼‰

1.ç®€å•é…ç½®ï¼š

```java
<!-- é…ç½®è§†å›¾è§£æå™¨ è¿›è¡Œjspè§£æï¼Œé»˜è®¤ä½¿ç”¨jstlæ ‡ç­¾ï¼Œclasspathä¸‹å¾—æœ‰jstlçš„åŒ…-->
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" />
<!--å¦‚æœè¿™æ ·é…ï¼Œé‚£ä¹ˆåœ¨ Handler ä¸­è¿”å›çš„å¿…é¡»æ˜¯å®Œæ•´è·¯å¾„ï¼ˆå«å®Œæ•´æ–‡ä»¶åï¼‰ã€‚-->
```

2.å®Œæ•´é…ç½®ï¼š

```java
<!--é…ç½®è§†å›¾è§£æå™¨  -->
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
 Â  Â <!-- è¿”å›è§†å›¾é¡µé¢çš„å‰ç¼€ -->
 Â  Â <property name="prefix" value="/WEB-INF/jsp/"></property>
 Â  Â <!-- è¿”å›é¡µé¢çš„åç¼€ -->
 Â  Â <property name="suffix" value=".jsp"></property>
</bean>
```

å¦‚æœè¿™æ ·é…ï¼Œé‚£ä¹ˆåœ¨ Handler ä¸­åªéœ€è¦è¿”å›åœ¨ pages æ–‡ä»¶å¤¹ä¸‹çš„**jsp é¡µé¢**åç§°å°±å¯ä»¥äº†ã€‚

ä¸‰ åŸºæœ¬é…ç½®

## 3.1 å¸¸è§„é…ç½®ï¼ˆControlleråŠ è½½æ§åˆ¶ï¼‰

- SpringMVCçš„å¤„ç†å™¨å¯¹åº”çš„beanå¿…é¡»æŒ‰ç…§è§„èŒƒæ ¼å¼å¼€å‘ï¼Œæœªé¿å…åŠ å…¥æ— æ•ˆçš„beanå¯é€šè¿‡beanåŠ è½½è¿‡æ»¤å™¨è¿›è¡ŒåŒ…å«è®¾å®šæˆ–æ’é™¤è®¾å®šï¼Œè¡¨ç°å±‚beanæ ‡æ³¨é€šå¸¸è®¾å®šä¸º@Controller  

**xmlæ–¹å¼**

```text
<context:component-scan base-package="com.by">
        <!--æŒ‡å®šåŒ…æ‰«æçš„åŒ…å«controller-->
 Â  Â <context:include-filter
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â type="annotation"
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â expression="org.springframework.stereotype.Controller"/>
    <!--å¼€å¯æ³¨è§£æ‰«æ-->
</context:component-scan>
```

**context:include-filter**æœ‰ä¸¤ä¸ªå¿…é¡»çš„å±æ€§ï¼š

**type:** é…ç½®filterçš„ç±»å‹ï¼Œè¿™ä¸ªç±»å‹ä¸€å…±æœ‰ä»¥ä¸‹äº”ä¸ªå€¼ï¼š

> assignable ---  æŒ‡å®šæ‰«ææŸä¸ªæ¥å£æ´¾ç”Ÿå‡ºæ¥çš„ç±»annotation --- æŒ‡å®šæ‰«æä½¿ç”¨æŸä¸ªæ³¨è§£çš„ç±»aspectj  ---   æŒ‡å®šæ‰«æAspectJè¡¨è¾¾å¼ç›¸åŒ¹é…çš„ç±»custom-æŒ‡å®šæ‰«æè‡ªå®šä¹‰çš„å®ç°äº†

**expression:** æ ¹æ®typeçš„ä¸åŒï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„é…ç½®æ–¹å¼ä¹Ÿä¸åŒã€‚

**1ã€assignable çš„ç”¨æ³•**

åˆ›å»ºæ¥å£ç±»ï¼š

```text
//æ ‡ç­¾
public interface Label {
}
```

Sellerç±»ï¼š æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨Sellerç±»ä¸Šæ–¹æ·»åŠ äº†æ ‡å‡†æ³¨è§£@Component,æ‰€ä»¥Sellerç±»ä¼šè¢«springåŠ è½½

```text
//ä¾›åº”å•†
@Component
public class Seller {
}
```

ManuFactureç±»ï¼šManuFactureç±»æ²¡æœ‰æ ‡æ³¨æ³¨è§£ï¼Œç†è®ºä¸Šä¸ä¼šè¢«SpringåŠ è½½ã€‚ä½†æ˜¯ManuFactureç±»å®ç°äº†æ¥å£Lable

```text
//å‚å•†
public class ManuFacture implements Label{
}
```

**spring-mvc.xmlé…ç½®**

```text
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
 Â  Â  Â  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 Â  Â  Â  xmlns:context="http://www.springframework.org/schema/context"
 Â  Â  Â  xmlns:mvc="http://www.springframework.org/schema/mvc"
 Â  Â  Â  xsi:schemaLocation="http://www.springframework.org/schema/beans
 Â  Â  Â  http://www.springframework.org/schema/beans/spring-beans.xsd
 Â  Â  Â  Â http://www.springframework.org/schema/context
 Â  Â  Â  http://www.springframework.org/schema/context/spring-context.xsd
 Â  Â  Â  Â http://www.springframework.org/schema/mvc
 Â  Â  Â  http://www.springframework.org/schema/mvc/spring-mvc.xsd">
â€‹
 Â  Â <context:component-scan base-package="com.by.pojo">
 Â  Â  Â  Â <!-- é€šçŸ¥springå°†å®ç°æ¥å£Labelçš„ç±»ä¹ŸåŠ è½½è¿›æ¥ -->
 Â  Â  Â  Â <context:include-filter type="assignable"
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â expression="com.by.pojo.Label"/>
 Â  Â </context:component-scan>
 Â  Â <!--å¼€å¯æ³¨è§£æ‰«æ-->
 Â  Â <mvc:annotation-driven/>
</beans>
```

æµ‹è¯•ç±»ï¼š

```text
public class AppTest {
â€‹
 Â  Â public static void main(String[] args) {
 Â  Â  Â  Â ApplicationContext ac=new ClassPathXmlApplicationContext("spring-mvc.xml");
 Â  Â  Â  Â System.out.println(ac.getBean(Seller.class));
 Â  Â  Â  Â System.out.println(ac.getBean(ManuFacture.class));
 Â   }
}
```

åŠ å…¥servlet-apiï¼š ä½¿ç”¨å®Œåˆ é™¤

```text
 <dependency>
 Â  Â  Â <groupId>tomcat</groupId>
 Â  Â  Â <artifactId>servlet-api</artifactId>
 Â  Â  Â <version>5.5.23</version>
 Â  Â </dependency>
```

**2ã€annotation --- æŒ‡å®šæ‰«æä½¿ç”¨æŸä¸ªæ³¨è§£çš„ç±»**

åˆ›å»ºä¸€ä¸ªæ³¨è§£æ¥å£ç±»ï¼š ç±»ä¼¼@Controller

```text
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
public @interface DemoAnno {
 Â  
}
```

ManuFactureåŠ ä¸Šæˆ‘ä»¬é…ç½®çš„æ³¨è§£

```text
@DemoAnno
public class ManuFacture {
}
```

spring-mvc.xmlé…ç½®ï¼š

```text
 Â  <!-- é€šçŸ¥springå°†æœ‰æŒ‡å®šæ³¨è§£çš„ç±»åŠ è½½è¿›æ¥ -->
<context:include-filter type="annotation" expression="com.by.pojo.DemoAnno"/>
```

æµ‹è¯•ç±»ä¸å˜ï¼šç›´æ¥è¿è¡Œ

**3ã€aspectj-**æŒ‡å®šæ‰«æAspectJè¡¨è¾¾å¼ç›¸åŒ¹é…çš„ç±»:æ¯”å¦‚è¦æ±‚åŠ è½½æŸä¸ªç±»çš„æ´¾ç”Ÿç±»

è¿™é‡Œéœ€è¦æ·»åŠ AspectJçš„ä¾èµ–:

```text
 <dependency>
 Â  Â  Â <groupId>org.springframework</groupId>
 Â  Â  Â <artifactId>spring-aspects</artifactId>
 Â  Â  Â <version>5.3.20</version>
 Â  Â </dependency>
```

æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–°çš„CommBarç±»ï¼š

```text
public class CommBar {
}
```

ç»§ç»­ä¿®æ”¹æˆ‘ä»¬çš„ManuFactureç±»ï¼Œä¸å®ç°æ¥å£ï¼Œä¸éœ€è¦æ³¨è§£ï¼Œåªè¦ç»§æ‰¿CommBarç±»å³å¯ã€‚

```text
public class ManuFacture extends CommBar{
}
```

mvc.xmlé…ç½®

```text
<!-- é€šçŸ¥springæ‰€æœ‰ç»§æ‰¿å’Œæ‰©å±•è‡ªæŒ‡å®šç±»çš„ç±»å…¨éƒ¨åŠ è½½è¿›æ¥ -->
 <context:include-filter type="aspectj" expression="com.by.pojo.CommBar+"/>
```

ç›´æ¥æµ‹è¯•è¿è¡Œ

**4ã€custom---**æŒ‡å®šæ‰«æè‡ªå®šä¹‰çš„å®ç°äº†org.springframework.core.type.filter.TypeFilteræ¥å£çš„ç±»

ç»§ç»­ä¿®æ”¹æˆ‘ä»¬çš„ManuFactureç±»ï¼Œä¸å®ç°æ¥å£ï¼Œä¸éœ€è¦æ³¨è§£ï¼Œä¸ç»§æ‰¿ä»»ä½•ç±»ã€‚

```text
public class ManuFacture {
}
```

æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªMyFilterå®ç°TypeFilteræ¥å£:

```text
public class MyFilter implements TypeFilter {
 Â  Â @Override
 Â  Â public boolean match(MetadataReader metadataReader,
 Â  Â  Â  Â  Â  Â  Â  Â  MetadataReaderFactory metadataReaderFactory) throws IOException {
 Â  Â  Â  Â //è¿™é‡Œåˆ¤æ–­è¯»å–çš„ç±»å‹æ˜¯å¦æ˜¯ManuFactureï¼Œå¦‚æœæ˜¯å°±è¿”å›trueï¼Œå¦åˆ™è¿”å›falseï¼›
 Â  Â  Â  Â // è¿”å›trueå°±ä¼šè¢«springåŠ è½½ï¼Œå¦åˆ™ä¸åŠ è½½
 Â  Â  if(metadataReader.getClassMetadata().getClassName().equals(ManuFacture.class.getName())){
 Â  Â  Â  Â  Â return true;
 Â  Â  Â   }
 Â  Â  Â  Â return false;
 Â   }
}
```

mvcé…ç½®ç±»ï¼š

```text
 <!-- é€šçŸ¥springæ ¹æ®æˆ‘ä»¬é…ç½®çš„MyFilterç±»è¿›è¡ŒåŠ è½½ è¿™é‡Œçš„ expressionè¦é…ç½®æˆ‘ä»¬è‡ªå·±çš„MyFilter -->
 Â <context:include-filter type="custom" expression="com.by.pojo.MyFilter"/>
```

ç›´æ¥è¿è¡Œå³å¯

é—®é¢˜æŸ¥æ‰¾ç½‘å€ï¼š[https://kaifa.baidu.com](https://kaifa.baidu.com/)

**å›åˆ°ä¹‹å‰çš„é…ç½®ï¼š**

```text
<context:component-scan base-package="com.by">
        <!--æŒ‡å®šåŒ…æ‰«æçš„åŒ…å«controller-->
 Â  Â <context:include-filter
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â type="annotation"
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â expression="org.springframework.stereotype.Controller"/>
    <!--å¼€å¯æ³¨è§£æ‰«æ-->
</context:component-scan>
```

**controllerä¸­ç¼–å†™ï¼š**

```text
@Controller
public class HelloWord2  {
 Â  Â @RequestMapping("/hello2")
 Â  Â public ModelAndView handleRequest() throws ServletException, IOException {
 Â  Â  Â  Â ModelAndView mv=new ModelAndView();
 Â  Â  Â  Â mv.setViewName("success");
 Â  Â  Â  Â mv.addObject("msg","ç»™ä¸äº†çš„æ°¸è¿œéƒ½æ˜¯ç©ºçš„");
 Â  Â  Â  Â return mv;
 Â   }
}
```

**ä½¿ç”¨ @EnableWebMvc æ³¨è§£ ä»£æ›¿é…ç½®**

```text
<mvc:annotation-driven> å’Œ @EnableWebMvc è§£æ
è¿™ä¸¤ä¸ªèµ·åˆ°çš„ä½œç”¨æ˜¯ç±»ä¼¼çš„(é¿å…é‡å¤æ³¨å†Œ,äºŒé€‰ä¸€å³å¯), éƒ½æ˜¯æ³¨å†Œäº†å¤§éƒ¨åˆ†spring mvcå¼€å‘æ‰€éœ€çš„bean(HandlerMapping,HandlerAdapterç­‰ç­‰),
è¿˜æœ‰æ ¹æ®åŒ…å­˜åœ¨æ·»åŠ messageConverter(ä¾‹å¦‚jackson,ä»¥æ”¯æŒ@ResponseBody).
```

**é…ç½®ç±»ç¼–å†™**

```text
@Configuration
//å¼€å¯ Spring MVCæ³¨è§£é©±åŠ¨
@EnableWebMvc
public class WebConfig implements WebMvcConfigurer {
 Â  Â /*
 Â  Â é…ç½®è§†å›¾è§£æå™¨
 Â  Â */
 Â  Â @Override
 Â  Â public void configureViewResolvers(ViewResolverRegistry registry) {
 Â  Â  Â  Â WebMvcConfigurer.super.configureViewResolvers(registry);
 Â  Â  Â  Â //æ³¨å†Œåˆ°è§†å›¾é…ç½®ä¸­
 Â  Â  Â  Â registry.viewResolver(resourceViewResolver());
 Â   }
 Â  Â /**
 Â  Â  * é…ç½®è¯·æ±‚è§†å›¾æ˜ å°„
 Â  Â  */
 Â  Â private InternalResourceViewResolver resourceViewResolver(){
 Â  Â  Â  Â InternalResourceViewResolver viewResolver=new InternalResourceViewResolver();
 Â  Â  Â  Â //è¯·æ±‚è§†å›¾çš„å‰ç¼€
 Â  Â  Â  Â viewResolver.setPrefix("/WEB-INF/");
 Â  Â  Â  Â //è¯·æ±‚è§†å›¾çš„åç¼€
 Â  Â  Â  Â viewResolver.setSuffix(".jsp");
 Â  Â  Â  Â return Â viewResolver;
 Â   }
}
```

**controllerç¼–å†™ï¼š**

```java
@Controller
public class HelloWord3  {
    @RequestMapping("/hello3")
    public ModelAndView query() {
        ModelAndView mv=new ModelAndView();
        //å¦‚æœxmlç»Ÿä¸€é…ç½®è·¯å¾„ï¼Œå¯ä»¥ç®€å†™ç¨‹æ–‡ä»¶å
        mv.setViewName("success");
        mv.addObject("msg","ä½¿ç”¨é…ç½®ç±»æ“ä½œ");
        return mv;
    }
}

```

